# 컴퓨터 네트워크: TCP/IP 인터넷 계층

## 핵심 요약

본 문서는 TCP/IP 프로토콜 스위트의 인터넷 계층(Internet Layer)과 네트워크 액세스 계층(Network Access Layer)의 핵심 기능과 주요 프로토콜을 종합적으로 분석한다. 인터넷 계층은 OSI 7계층 모델의 3계층에 해당하며, 호스트 간 데이터 전송을 위한 주소 지정(Addressing)과 경로 설정(Routing)을 담당한다. 이 계층의 핵심 원칙은 '최선 노력 전송(Best-Effort delivery)'으로, 데이터 전송을 100% 보장하지는 않는다.

주요 프로토콜은 다음과 같다:

- **IP (Internet Protocol)**: 논리적 주소를 사용하여 패킷을 전송하는 핵심 프로토콜이다. IPv4의 주소 고갈 문제를 해결하고 효율성 및 보안을 강화한 IPv6가 차세대 표준으로 자리 잡고 있다.
- **ICMP (Internet Control Message Protocol)**: IP의 비신뢰성(Best-Effort)을 보완하기 위해 네트워크 통신 중 발생하는 오류나 제어 메시지를 송신 측에 전달하는 진단 프로토콜이다. `ping`, `traceroute`와 같은 명령어가 이를 활용한다.
- **ARP (Address Resolution Protocol)**: 논리적 주소인 IP 주소를 물리적 하드웨어 주소인 MAC 주소로 변환하여 실제 데이터 링크 상에서 통신이 가능하도록 하는 필수 프로토콜이다.

네트워크 액세스 계층은 OSI 1, 2계층에 해당하며, 물리적 네트워크 매체를 통한 실제 데이터 송수신을 담당한다.

--------------------------------------------------------------------------------

## 1. TCP/IP 계층 구조: 인터넷 및 네트워크 액세스 계층

TCP/IP 모델에서 데이터 통신은 여러 계층으로 나뉘어 처리되며, 그중 인터넷 계층과 네트워크 액세스 계층은 네트워크의 근간을 이룬다.

### 1.1. 인터넷 계층 (Internet Layer)

인터넷 계층은 전체 네트워크의 핵심으로, 서로 다른 네트워크에 연결된 컴퓨팅 시스템(호스트) 간의 데이터 패킷 전송을 책임진다.

- **주요 기능**:
    - **주소 지정 (Addressing)**: IP 주소라는 고유한 논리적 주소를 각 호스트에 부여하고 이를 기반으로 송신자와 수신자를 식별한다.
    - **경로 설정 (Routing)**: 패킷이 목적지까지 도달하기 위한 최적의 경로를 결정하고 데이터를 전달한다.
- **전송 방식**:
    - **최선 노력 전송 (Best-Effort Delivery)**: 데이터 전송을 보장하지 않으며, 패킷이 유실되거나 순서가 뒤바뀌어 도착할 수 있다. 신뢰성 있는 전송은 상위 계층(전송 계층)의 역할이다.
- **OSI 모델과의 관계**: OSI 7계층 모델의 3계층(네트워크 계층)에 해당한다.
- **주요 프로토콜**: IP, ARP, ICMP, IGMP 등이 이 계층에 속한다.

### 1.2. 네트워크 액세스 계층 (Network Access Layer)

네트워크 액세스 계층은 실제 물리적 네트워크 매체(예: 이더넷 케이블)를 통해 데이터를 주고받는 역할을 수행한다.

- **주요 기능**:
    - 물리적 네트워크를 통한 데이터의 송신 및 수신을 직접 담당한다.
    - 물리적 주소인 MAC 주소를 사용하여 동일 네트워크 내에서 장치를 식별한다.
- **OSI 모델과의 관계**: OSI 7계층 모델의 1계층(물리 계층)과 2계층(데이터 링크 계층)에 해당한다.

## 2. 인터넷 프로토콜(IP): IPv4와 IPv6

IP는 인터넷 계층의 가장 중요한 프로토콜로, 패킷을 목적지까지 전송하는 역할을 한다. 현재 주로 사용되는 IPv4와 차세대 프로토콜인 IPv6로 구분된다.

### 2.1. IP 프로토콜의 공통 특징

- **비신뢰성**: 'Best-Effort' 방식으로 동작하므로 데이터 전송을 100% 보장하지 않는다.
- **패킷 분할 및 병합**: 데이터 전송 과정에서 네트워크 환경에 맞춰 패킷을 더 작은 단위로 분할하고, 목적지에서 이를 다시 병합한다.
- **오류 점검**: 헤더 체크섬(Header Checksum)을 이용하여 전송 중 헤더에 발생한 오류를 검사한다.
- **주소 체계**: 논리적 주소인 IP 주소를 사용하여 데이터를 전송한다.

### 2.2. IPv4 (Internet Protocol version 4)

IPv4는 32비트 주소 체계를 사용하는 현재 가장 널리 사용되는 프로토콜이다. 헤더는 데이터 패킷에 대한 중요한 정보를 담고 있다.

- **주요 헤더 필드**:
    - **Version**: IP 프로토콜의 버전(IPv4는 4).
    - **Time to Live (TTL)**: 패킷이 네트워크 내에서 무한히 순환하는 것을 방지하기 위한 생존 시간.
    - **Fragment Offset**: 분할된 패킷의 순서를 식별하기 위한 정보.
    - **Source IP Address**: 송신 호스트의 IP 주소.
    - **Destination IP Address**: 수신 호스트의 IP 주소.

### 2.3. IPv6 (Internet Protocol version 6)

IPv6는 IPv4의 주소 부족 문제를 해결하기 위해 등장한 128비트 주소 체계를 사용하는 차세대 프로토콜이다. 주소 공간 확장 외에도 다양한 기능 개선이 이루어졌다.

- **주요 특징**:
    - **주소 공간 확장**: 128비트 주소 체계를 사용하여 사실상 무한에 가까운 주소 할당이 가능하다.
    - **호스트 주소 자동 설정**: 호스트가 네트워크에 접속하는 즉시 자동으로 네트워크 주소를 할당받을 수 있다.
    - **패킷 크기 확장**: 점보그램(Jumbogram) 옵션을 통해 64KB로 제한되었던 IPv4의 패킷 크기 한계를 극복하고 임의의 큰 패킷을 전송할 수 있다.
    - **효율적인 라우팅**: 헤더를 고정 크기의 단순한 구조로 설계하여 라우터가 신속하게 패킷을 처리할 수 있으며, 필요시 확장 헤더를 통해 유연성을 제공한다.
    - **품질(QoS) 및 보안 강화**: 플로우 레이블(Flow Label) 필드를 이용해 특정 데이터 흐름에 대한 서비스 품질(QoS) 지정이 가능하다. 또한, 확장 헤더를 통해 데이터 인증 및 무결성 지원과 같은 보안 기능을 기본적으로 지원한다.

## 3. 지원 프로토콜: ICMP와 ARP

IP 프로토콜의 원활한 동작을 위해 인터넷 계층에서는 ICMP와 ARP와 같은 지원 프로토콜이 사용된다.

### 3.1. ICMP (Internet Control Message Protocol)

ICMP는 IP 통신의 신뢰성 부족을 보완하는 역할을 한다. 네트워크 장비 오류나 통신 장애 등 전송 과정에서 발생하는 문제점을 발견하고, 그 정보를 송신 측에 전달하는 진단 및 제어 메시지 프로토콜이다.

- **주요 역할**: IP 통신의 제약 사항(장애 대처 불가)을 보완하고, 네트워크 통신 시 발생 가능한 오류 정보를 송신 측에 전달한다.
- **관련 명령어**:
    - `ping`: 대상 시스템과의 IP 통신 가능 여부를 확인한다. ICMP Echo Request/Reply 메시지를 사용한다.
    - `traceroute` (리눅스) / `tracert` (윈도우): 목적지까지 도달하는 동안 거치는 라우팅 경로를 확인한다.

### 3.2. ARP (Address Resolution Protocol)

ARP는 논리적 주소인 IP 주소를 기반으로 실제 통신에 필요한 물리적 주소인 MAC 주소를 알아내기 위해 사용되는 프로토콜이다.

- **핵심 기능**: IP 주소 → MAC 주소 변환.
- **ARP 동작 방식**:

| 단계    | 과정                   | 설명                                                                                          |
| :---- | :------------------- | :------------------------------------------------------------------------------------------ |
| **1** | **ARP Cache 확인**     | 통신을 시작하기 전, 자신의 메모리(ARP Cache)에 목적지 IP에 해당하는 MAC 주소 정보가 있는지 먼저 확인한다.                        |
| **2** | **ARP Request (요청)** | 캐시에 정보가 없으면, 로컬 네트워크 전체에 "해당 IP 주소를 가진 호스트는 MAC 주소를 알려달라"는 **브로드캐스트(Broadcast)** 메시지를 전송한다. |
| **3** | **ARP Reply (응답)**   | 요청받은 IP 주소를 사용하는 호스트가 자신의 MAC 주소를 담아 요청한 호스트에게 **유니캐스트(Unicast)**로 응답 메시지를 보낸다.             |
| **4** | **ARP Cache 갱신**     | 응답받은 IP-MAC 매핑 정보를 자신의 ARP Cache에 저장하여 이후 통신 시 재사용한다. `arp –a` 명령어로 캐시 내용을 확인할 수 있다.        |
| **5** | **ARP Cache 관리**     | 일정 시간 동안 통신이 없는 캐시 정보는 자동으로 삭제하여 정보의 유효성을 유지한다.                                             |
|       |                      |                                                                                             |

## 4. 네트워크 데이터 분석 환경

네트워크 통신 과정을 상세히 분석하고 문제를 해결하기 위해 패킷 분석 도구가 사용된다.

- **주요 도구**: **와이어샤크(Wireshark)**를 이용하여 네트워크를 통해 전송되는 실제 데이터 패킷을 캡처하고 분석하는 실습 환경을 구성할 수 있다.