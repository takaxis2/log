# 네트워크 기반 서비스 : DNS, FTP, SMB, SMTP

## 요약

본 문서는 TCP/IP 응용 계층의 핵심 네트워크 기반 서비스인 DNS, FTP, SMB 및 이메일 관련 프로토콜의 주요 특징과 동작 방식을 종합적으로 분석한다. 각 서비스는 현대 네트워크 통신의 근간을 이루며, 뚜렷한 목적과 고유한 동작 메커니즘을 가지고 있다.

- **DNS (Domain Name Service):** 사용자가 이해하기 쉬운 도메인 이름(예: www.exam.com)을 컴퓨터가 통신에 사용하는 IP 주소(예: 172.30.1.3)로 변환하는 핵심적인 주소 해석 시스템이다. 이 과정은 로컬 캐시 확인부터 시작하여 여러 DNS 서버에 대한 계층적 질의를 통해 이루어진다.
- **파일 전송 및 공유 프로토콜:**
    - **FTP (File Transfer Protocol):** TCP/IP를 기반으로 클라이언트와 서버 간의 파일 전송을 목적으로 하는 프로토콜이다. 표준적으로 20번과 21번 포트를 사용한다.
    - **SMB (Server Message Block):** 파일, 디렉터리, 프린터와 같은 주변 장치를 네트워크상에서 공유하기 위해 사용되는 프로토콜이며, '삼바(Samba)'는 SMB를 활용한 대표적인 서비스이다.
- **이메일 프로토콜:** 이메일 통신은 기능에 따라 여러 프로토콜의 조합으로 이루어진다.
    - **SMTP (Simple Mail Transfer Protocol):** TCP/25 포트를 사용하여 이메일을 **전송**하는 역할을 담당한다.
    - **POP3 및 IMAP:** 메일을 **수신**하는 프로토콜로, POP3(TCP/110)는 메일을 서버에서 클라이언트로 가져온 후 서버에서 삭제하는 반면, IMAP(TCP/143)은 서버에 메일을 보존한 상태로 읽을 수 있게 하여 여러 장치에서의 접근을 용이하게 한다.

--------------------------------------------------------------------------------

## 1. 도메인 네임 시스템 (DNS) 분석

DNS는 도메인 이름과 IP 주소 간의 변환을 수행하는 분산 데이터베이스 시스템이다. 이를 통해 사용자는 복잡한 IP 주소 대신 직관적인 도메인 이름으로 웹사이트나 서비스에 접근할 수 있다.

### DNS의 동작 방식

도메인 이름에 대한 IP 주소 요청 시, 시스템은 다음과 같은 순차적인 절차를 통해 주소를 확인한다.

1. **로컬 DNS 캐시 확인:** 가장 먼저 요청 PC의 메모리에 저장된 DNS 캐시 정보를 확인한다.
2. **hosts 파일 확인:** 로컬 시스템의 hosts 파일을 검사하여 해당 도메인에 대한 IP 주소 매핑 정보가 있는지 확인한다.
3. **Local DNS 서버에 질의 (Query):** 위 두 단계에서 정보를 찾지 못하면, 시스템은 설정된 Local DNS 서버에 IP 주소를 질의한다.
4. **계층적 질의 (Recursive Query):**
    - Local DNS 서버에 해당 정보가 없으면, 서버는 최상위 **Root DNS** 서버에 질의한다.
    - Root DNS 서버에도 정보가 없을 경우, 해당 도메인의 TLD(최상위 도메인, 예: .com)를 관리하는 DNS 서버에 질의하도록 안내한다.
    - Local DNS 서버는 이 과정을 반복하며 최종적으로 해당 도메인의 IP 주소 정보를 얻는다.
5. **캐싱 및 응답:**
    - IP 주소를 회신 받은 Local DNS 서버는 해당 정보를 일정 기간 캐싱(Caching)하여 추후 동일한 요청에 빠르게 응답할 수 있도록 한다.
    - 최초 요청을 보낸 호스트(PC)의 DNS 캐시 정보 또한 새로운 IP 주소로 갱신된다.

### DNS 레코드 타입

DNS는 다양한 유형의 레코드(Record)를 통해 도메인 관련 정보를 관리한다. 주요 레코드 타입은 다음과 같다.

|   |   |   |
|---|---|---|
|레코드 타입|명칭|설명|
|**A**|Address Mapping Records|도메인 이름에 해당하는 IPv4 주소.|
|**AAAA**|IPv6 Address Records|도메인 이름에 해당하는 IPv6 주소.|
|**CNAME**|Canonical Name|특정 도메인 이름에 대한 별칭(Alias)을 지정.|
|**HINFO**|Host Information|호스트의 CPU, 운영체제(OS) 유형 등 하드웨어 및 소프트웨어 정보.|
|**MX**|Mail Exchanger|해당 도메인으로 이메일을 라우팅하는 메일 교환 서버를 지정.|
|**NS**|Name Server|해당 도메인을 관리하는 공식 네임 서버를 지정.|
|**PTR**|Reverse-lookup Pointer|IP 주소를 기반으로 해당 IP에 매핑된 도메인 이름을 반환. (역방향 조회)|
|**SOA**|Start of Authority|도메인 관리자 이메일, 일련번호 등 DNS 영역(Zone)의 핵심 정보를 지정.|

### 관련 명령어

- `ipconfig /flushdns`: Windows 환경에서 로컬 DNS 캐시를 초기화하는 명령어.
- `nslookup`: DNS 서버에 직접 도메인 관련 정보를 질의하는 유틸리티. `-type=a` 옵션을 사용하여 IPv4 주소를 조회할 수 있다.
- `/etc/resolv.conf`: 리눅스 환경에서 사용할 네임 서버(Name Server)가 등록된 설정 파일.

## 2. 파일 전송 및 공유 프로토콜

### 파일 전송 프로토콜 (FTP)

FTP(File Transfer Protocol)는 TCP/IP 프로토콜 스위트를 기반으로 서버와 클라이언트 간에 파일을 전송하기 위해 설계된 응용 서비스 및 프로토콜이다.

- **주요 기능:** 네트워크를 통한 파일 업로드 및 다운로드.
- **사용 포트:** 기본적으로 20번과 21번 포트를 사용한다.
- **동작 모드:** 소스 자료에 따르면 Active Mode와 Passive Mode 두 가지 동작 방식이 존재한다.

### 서버 메시지 블록 (SMB)

SMB(Server Message Block)는 네트워크상의 다른 컴퓨터에 있는 파일, 디렉터리, 프린터 등 주변 장치를 공유하기 위해 사용되는 프로토콜이다.

- **삼바 (Samba):** SMB 프로토콜을 이용하여 유닉스/리눅스 시스템과 윈도우 시스템 간에 자원을 공유할 수 있도록 개발된 오픈소스 서비스이다.
- **주요 구성 요소 및 포트:**
    - **smbd (SMBDaemon):** SMB 프로토콜의 핵심 기능을 담당하는 데몬.
    - **nmbd (NMB Daemon):** WINS 서비스를 위한 데몬으로, 브로드캐스팅 방식을 통해 네트워크상의 호스트를 검색하고 접속을 지원한다.
    - **TCP 445 (Direct SMB):** IP 주소를 이용하여 NetBIOS 없이 직접 SMB에 접속하는 포트.
    - **UDP 137 (NetBIOS Name Service):** 호스트 이름 해석을 담당.
    - **UDP 138 (NetBIOS Datagram Service):** 데이터그램 전송을 담당.
    - **TCP 139 (NetBIOS Session Service):** 세션 기반 통신을 담당.

## 3. 이메일 서비스 프로토콜

이메일 서비스는 메일을 전송하는 프로토콜과 수신하는 프로토콜이 분리되어 동작한다. 각 프로토콜은 고유의 포트 번호와 역할을 가진다.

|   |   |   |   |
|---|---|---|---|
|프로토콜|전체 이름|포트|주요 기능 및 특징|
|**SMTP**|Simple Mail Transfer Protocol|**TCP/25**|클라이언트에서 서버로, 또는 서버 간에 이메일을 **전송**하기 위한 프로토콜.|
|**POP3**|Post Office Protocol Version 3|**TCP/110**|메일 서버에 도착한 이메일을 클라이언트로 **수신**하는 프로토콜. 수신 후 해당 메일은 **서버에서 삭제**되는 것이 기본 동작이다.|
|**IMAP**|Internet Messaging Access Protocol|**TCP/143**|메일을 **서버에서 삭제하지 않은 상태**로 수신하는 프로토콜. 여러 장치에서 동일한 메일함에 동기화된 상태로 접근할 수 있다.|